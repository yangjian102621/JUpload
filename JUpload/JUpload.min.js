!function(t){void 0==Array.prototype.remove&&(Array.prototype.remove=function(t){for(var i=0;i<this.length;i++)if(this[i]==t){this.splice(i,1);break}}),t.fn.imageCrop||(t.fn.imageCrop=function(i,n){t(this).on("load",function(){var e,a,o,r,c=this.width/this.height,p=i/n;c>=p?(a=n,e=i*c,r=0,o=(e-i)/2):(e=i,a=n/c,o=0,r=0),t(this).css({position:"absolute",top:-r+"px",left:-o+"px",width:e+"px",height:a+"px"})})}),t.fn.JUpload=function(n){function e(n){if("0"==n.code){var e=new i;e.append('<div class="img-wrapper"><div class="img-container" style="width: '+a.twidth+"px; height: "+a.theight+'px">'),e.append('<img src="'+n.message+'">'),e.append('<div class="file-opt-box clearfix"><span class="remove">删除</span></div></div></div>');var c=t(e.toString());t("#"+a.image_container).append(c),c.find("img").imageCrop(a.twidth,a.theight),c.find(".remove").on("click",function(){try{var i=t(this).parent().prev().attr("src");r.remove(i),c.remove(),t(o).attr("data-src",r.join(","))}catch(n){console.log(n)}}),r.push(n.message),t(o).attr("data-src",r.join(","))}}var a=t.extend({src:"src",url:null,callback:null,image_container:null,twidth:113,theight:113},n),o=this,r=[],c="iframe_"+Math.random(),p=t('<form action="'+a.url+'" target="'+c+'" enctype="multipart/form-data" method="post"></form>'),s=t('<input type="file" name="'+a.src+'" class="upload-input" />'),l=t('<iframe name="'+c+'" class="upload-iframe"></iframe>');t(this).on("click",function(){s.trigger("click")}),s.on("change",function(){p[0].submit()}),l.on("load",function(){var i=this.contentWindow.document.getElementsByTagName("body")[0].innerHTML;if(!i)return!1;try{var n=t.parseJSON(i);"function"==typeof a.callback?a.callback(n):null!=a.image_container&&e(n)}catch(o){console.log(o)}}),p.append(s),t("body").append(p),t("body").append(l),a.image_container&&t("#"+a.image_container).addClass("clearfix")};var i=function(){var t=new Array;i.prototype.append=function(i){t.push(i)},i.prototype.toString=function(){return t.join("")}}}(jQuery);